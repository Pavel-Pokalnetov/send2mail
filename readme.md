# Утилита для отправки писем с вложениями

Этот скрипт предоставляет удобный способ отправки электронных писем с вложениями через командную строку с использованием SMTP-сервера.

## Возможности

- Отправка одного или нескольких файлов в виде вложений
- Настройка SMTP-сервера с возможностью использования SSL/TLS
- Аутентификация на SMTP-сервере
- Гибкая настройка темы и текста письма
- Автоматическая генерация текста письма при отсутствии пользовательского текста

## Требования

- Python 3.x
- Установленные стандартные библиотеки Python:
  - `sys`
  - `os`
  - `argparse`
  - `smtplib`
  - `email.mime.multipart`
  - `email.mime.text`
  - `email.mime.application`

## Установка

1. Скопируйте скрипт в файл с именем `mail_sender.py`
2. Убедитесь, что файл имеет права на выполнение:
   ```bash
   chmod +x mail_sender.py
   ```

## Использование

### Базовый синтаксис

```bash
python mail_sender.py --server SMTP_SERVER --port PORT --to RECIPIENT_EMAIL --files FILE1,FILE2 [OPTIONS]
```

### Обязательные параметры

- `--server` - адрес SMTP-сервера (например, `smtp.example.com`)
- `--port` - порт SMTP-сервера (например, `25`, `465` или `587`)
- `--to` - email адрес получателя
- `--files` - список файлов для отправки через запятую (например, `file1.txt,file2.pdf`)

### Необязательные параметры

- `--from` - email отправителя (по умолчанию: `noreply@slenergo.ru`)
- `--subject` - тема письма (по умолчанию: "Вам отправлен файл(ы)")
- `--text` - текст письма (если не указан, генерируется автоматически)
- `--auth` - данные для аутентификации в формате `логин:пароль`
- `--ssl` - использовать SSL/TLS (флаг, не требует значения)

### Примеры использования

1. Простая отправка без аутентификации:
   ```bash
   python mail_sender.py --server smtp.example.com --port 25 --to recipient@example.com --files document.pdf
   ```

2. Отправка с аутентификацией и SSL:
   ```bash
   python mail_sender.py --server smtp.example.com --port 465 --to recipient@example.com --files doc1.pdf,doc2.xlsx --auth user:password --ssl
   ```

3. Отправка с пользовательским текстом и темой:
   ```bash
   python mail_sender.py --server smtp.example.com --port 587 --to recipient@example.com --files report.csv --subject "Ежемесячный отчет" --text "Добрый день,\n\nВо вложении отправляю ежемесячный отчет.\n\nС уважением,\nИван Иванов"
   ```

## Формат письма

Если текст письма не указан явно через параметр `--text`, скрипт автоматически генерирует текст следующего формата:

```
Вам отправлены файлы:
1. имя_файла1
2. имя_файла2
...
______________________________________________________________
Это письмо сформировано автоматически роботом отправки данных.
Отвечать на него не нужно, да и бесполезно.
Email для связи с администратором: admin@slenergo.ru
```

## Коды возврата

- `0` - письмо успешно отправлено
- `1` - произошла ошибка при отправке письма или добавлении вложений

## Безопасность

- Пароль передается в открытом виде в командной строке. Для повышения безопасности рекомендуется:
  - Использовать переменные окружения для хранения учетных данных
  - Ограничивать доступ к файлу скрипта
  - Использовать SSL/TLS при подключении к SMTP-серверу
- Скрипт не сохраняет историю отправленных писем и не ведет логов

## Ограничения

- Поддерживается только один получатель
- Максимальный размер вложений ограничен настройками SMTP-сервера
- Нет поддержки HTML-форматирования текста письма

## Лицензия

Скрипт предоставляется "как есть". Автор не несет ответственности за возможные проблемы, вызванные его использованием.